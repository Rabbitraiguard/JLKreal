# JLK Transservice - ระบบใบเสนอราคาและจัดการอีเมล

## คุณสมบัติหลัก

✅ **ฟอร์มขอใบเสนอราคาที่ใช้งานได้จริง**
- ส่งข้อมูลลูกค้าไปยังอีเมล: `jlktransservice@gmail.com` และ `meowkumaxd@gmail.com`
- ระบบตอบกลับอัตโนมัติให้ลูกค้า
- เก็บข้อมูลในฐานข้อมูล SQLite

✅ **แผงควบคุมสำหรับผู้ดูแลระบบ**
- ดูและจัดการใบเสนอราคาทั้งหมด
- เปลี่ยนสถานะการดำเนินการ
- จัดการลำดับข้อมูลในอีเมล (ลากและวาง)
- ตัวอย่างอีเมลแบบเรียลไทม์

✅ **ระบบอีเมลที่สวยงาม**
- เทมเพลตอีเมล HTML ที่ออกแบบมาเป็นพิเศษ
- แสดงข้อมูลแบบตารางที่อ่านง่าย
- รองรับการแสดงผลบนอุปกรณ์มือถือ

## การติดตั้งและใช้งาน

### 1. ติดตั้ง Dependencies

```bash
pip install -r requirements.txt
```

### 2. ตั้งค่าอีเมล

สร้างไฟล์ `.env` ในโฟลเดอร์หลัก:

```bash
# .env
EMAIL_PASSWORD=your-gmail-app-password
```

**วิธีการสร้าง Gmail App Password:**

1. เข้าสู่ระบบ Gmail ด้วยบัญชี `jlktransservice@gmail.com`
2. ไปที่ Google Account Settings → Security
3. เปิดใช้งาน 2-Step Verification
4. ในส่วน "App passwords" สร้างรหัสผ่านใหม่
5. เลือก "Mail" และ "Other (custom name)"
6. ตั้งชื่อเป็น "JLK Transservice"
7. คัดลอกรหัสผ่าน 16 หลักมาใส่ในไฟล์ `.env`

### 3. เริ่มต้นใช้งาน

```bash
python app.py
```

เซิร์ฟเวอร์จะทำงานที่: `http://localhost:5000`

### 4. เข้าใช้งานระบบ

**หน้าเว็บหลัก:**
- `http://localhost:5000` - หน้าแรก
- `http://localhost:5000/quote.html` - ฟอร์มขอใบเสนอราคา
- `http://localhost:5000/admin.html` - แผงควบคุมผู้ดูแลระบบ

**API Endpoints:**
- `POST /api/quote` - ส่งใบเสนอราคา
- `GET /api/quotes` - ดูใบเสนอราคาทั้งหมด
- `PUT /api/quotes/{id}/status` - อัปเดตสถานะ

## การใช้งานแผงควบคุม (Admin Panel)

### เข้าถึงแผงควบคุม
เปิดเบราว์เซอร์และไปที่: `http://localhost:5000/admin.html`

### คุณสมบัติหลัก:

#### 1. **แดชบอร์ด**
- สถิติใบเสนอราคาแบบเรียลไทม์
- ใบเสนอราคาล่าสุด
- จำนวนคำขอตามสถานะต่างๆ

#### 2. **จัดการใบเสนอราคา**
- ดูรายการใบเสนอราคาทั้งหมด
- กรองตามสถานะ
- ดูรายละเอียดและเปลี่ยนสถานะ
- ติดต่อลูกค้าโดยตรง (คลิกที่อีเมล/โทรศัพท์)

#### 3. **จัดการรูปแบบอีเมล**
- **ลากและวาง** เพื่อเปลี่ยนลำดับข้อมูลในอีเมล
- เปิด/ปิดการแสดงส่วนต่างๆ
- ดูตัวอย่างอีเมลแบบเรียลไทม์
- ตั้งค่าอีเมลปลายทาง

#### 4. **ตั้งค่าระบบ**
- ข้อมูลบริษัท
- เวลาทำการ
- เวลาตอบกลับ

## โครงสร้างไฟล์

```
JLK-Transservice/
├── app.py                 # Flask backend หลัก
├── requirements.txt       # Python dependencies
├── SETUP.md              # คู่มือการติดตั้ง
├── .env                  # ตั้งค่าอีเมล (สร้างเอง)
├── jlktran.db           # ฐานข้อมูล SQLite (สร้างอัตโนมัติ)
│
├── static/
│   ├── css/
│   │   └── style.css     # CSS หลัก
│   └── js/
│       ├── main.js       # JavaScript หลัก
│       ├── quote.js      # ฟอร์มใบเสนอราคา
│       └── admin.js      # แผงควบคุม
│
├── quote.html            # ฟอร์มขอใบเสนอราคา
├── admin.html            # แผงควบคุมผู้ดูแลระบบ
├── index.html            # หน้าแรก
├── services.html         # หน้าบริการ
├── about.html            # หน้าเกี่ยวกับเรา
└── contact.html          # หน้าติดต่อ
```

## การทดสอบระบบ

### 1. ทดสอบฟอร์มใบเสนอราคา
1. เปิด `http://localhost:5000/quote.html`
2. กรอกข้อมูลครบถ้วน
3. กดปุ่ม "ส่งคำขอใบเสนอราคา"
4. ตรวจสอบอีเมลที่ `jlktransservice@gmail.com` และ `meowkumaxd@gmail.com`

### 2. ทดสอบแผงควบคุม
1. เปิด `http://localhost:5000/admin.html`
2. ดูใบเสนอราคาที่เพิ่งส่ง
3. คลิกดูรายละเอียด
4. เปลี่ยนสถานะ
5. ทดสอบการจัดเรียงอีเมล

### 3. ทดสอบการส่งอีเมล
```bash
# ใน Python console
from app import send_email
result = send_email(
    'test@example.com',
    'ทดสอบ',
    '<h1>ทดสอบระบบอีเมล</h1>'
)
print(result)  # ควรได้ True
```

## การแก้ไขปัญหา

### ปัญหาการส่งอีเมล
- ตรวจสอบไฟล์ `.env` มีรหัสผ่านถูกต้อง
- ตรวจสอบ Gmail App Password ยังใช้งานได้
- ตรวจสอบการเชื่อมต่ออินเทอร์เน็ต

### ปัญหาฐานข้อมูล
- ไฟล์ `jlktran.db` จะสร้างอัตโนมัติ
- หากมีปัญหา ลบไฟล์และเริ่มใหม่

### ปัญหา JavaScript
- เปิด Developer Tools (F12)
- ตรวจสอบ Console สำหรับข้อผิดพลาด
- ตรวจสอบ Network tab สำหรับ API calls

## การปรับแต่งเพิ่มเติม

### เปลี่ยนอีเมลปลายทาง
แก้ไขในไฟล์ `app.py`:
```python
EMAIL_CONFIG = {
    # ...
    'company_emails': ['email1@domain.com', 'email2@domain.com']
}
```

### เปลี่ยนเทมเพลตอีเมล
แก้ไขในฟังก์ชัน `submit_quote()` ในไฟล์ `app.py`

### เพิ่มฟิลด์ใหม่
1. แก้ไข `quote.html` - เพิ่มฟิลด์ในฟอร์ม
2. แก้ไข `app.py` - เพิ่มฟิลด์ในฐานข้อมูลและอีเมล
3. แก้ไข `admin.js` - เพิ่มฟิลด์ในการแสดงผล

## การสำรองข้อมูล

### ฐานข้อมูล
```bash
cp jlktran.db jlktran_backup_$(date +%Y%m%d).db
```

### การตั้งค่า
สำรองไฟล์ `.env` และการตั้งค่าใน `app.py`

## การอัปเดต

เมื่อมีการอัปเดตโค้ด:
1. สำรองฐานข้อมูลและการตั้งค่า
2. ดึงโค้ดใหม่
3. ติดตั้ง dependencies ใหม่: `pip install -r requirements.txt`
4. เริ่มเซิร์ฟเวอร์ใหม่

## การสนับสนุน

หากมีปัญหาการใช้งาน:
1. ตรวจสอบ Console สำหรับข้อผิดพลาด
2. ตรวจสอบไฟล์ log
3. ทดสอบการเชื่อมต่ออีเมล
4. ตรวจสอบการตั้งค่า environment variables

---

**หมายเหตุ:** ระบบนี้พร้อมใช้งานจริงและส่งอีเมลไปยัง `jlktransservice@gmail.com` และ `meowkumaxd@gmail.com` ตามที่ร้องขอ